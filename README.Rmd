---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```

# rjaf


> Regularized and Clustered Joint Assignment Forests

Author list goes here

---
## Introduction

**rjaf** is an R package that implements a regularized and clustered joint assignment forest which targets joint assignment to one of many treatment arms as described in Ladhania, Spiess, Ungar, and Wu (2023). It utilizes a regularized forest-based greedy recursive algorithm to shrink effect estimates across arms and a clustering approach to combine treatment arm with similar outcomes. The optimal treatment assignment is estimated by pooling information across treatment arms. In this tutorial we introduce the use of **rjaf** through some datasets



## Installation

```{r}
require("devtools")
require("remotes")
devtools::install_github("https://github.com/wustat/rjaf/r-package/rjaf")
```


## What is regularized and clustered joint assignment forest? 


## Example

```{r}
library(rjaf)
```

The following scripts demonstrates the function ``rjaf()`` where a joint forest model to estimate the optimal treatment assignment by pooling information across treatment arms. By inputting training, estimation, and validation data with a clustering scheme, we can obtain final regularized predictions ``forest.reg`` and assignments, where it estimates 
#' regularized averages separately by the original treatment arms $k \\in \\{0,\ldots,K\\}$ 
#' and obtain the corresponding assignment.
```{r}
data("Example_data_clus")

Example_trainest <- Example_data_clus %>% slice_sample(n = floor(0.3 * nrow(Example_data_clus)))
Example_valid <- Example_data_clus %>% filter(!id %in% Example_trainest$id)

id <- "id"; trts <- as.character(0:5); y <- "Y"; trt <- "trt";  
vars <- paste0("X", 1:3); prob <- "prob";
forest.reg <- rjaf(Example_trainest, Example_valid, y, id, trt, vars, prob, clus.max = 3, clus.tree.growing = TRUE, clus.outcome.avg = FALSE)
```

## Citation

```
@article{,
  title = {lmtp: An R package for estimating the causal effects of modified treatment policies},
  author = {Nicholas T Williams and Iván Díaz},
  journal = {Observational Studies},
  year = {2023},
  url = {https://muse.jhu.edu/article/883479}
}

@article{
  doi:10.1080/01621459.2021.1955691,
  author = {Iván Díaz and Nicholas Williams and Katherine L. Hoffman and Edward J. Schenck},
  title = {Non-parametric causal effects based on longitudinal modified treatment policies},
  journal = {Journal of the American Statistical Association},
  year  = {2021},
  doi = {10.1080/01621459.2021.1955691},
  URL = {https://doi.org/10.1080/01621459.2021.1955691},
}
```

## References


